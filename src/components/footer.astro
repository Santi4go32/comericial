---
import { Picture } from "astro:assets";
import mockup from "assets/mockup.png";
import dashboard from "assets/dashboard.png";
import Link from "@components/ui/link.astro";
import { Icon } from "astro-icon/components";
import Navbar from "@components/navbar/navbar.astro";

import { getLangFromUrl,useTranslation } from "i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslation(lang);

const downloadUrl = lang === "en" ? "https://qqcapitalfund.com/wp-content/uploads/2024/07/Presentacion-Comercial-ingles.pdf" : "https://qqcapitalfund.com/wp-content/uploads/2024/07/Presentacion-Comercial-Espanol.pdf";
---

<footer id="registro" class="grid place-items-center relative min-h-screen bg-[#222222] mt-[5%]">
  <section class="main_banner w-full relative min-h-[500px] h-full"></section>

  <div class="lg:absolute lg:top-1/2 lg:left-1/2 lg:transform lg:-translate-x-[-225px] lg:-translate-y-1/2">
    <h1 class="text-5xl text-white font-medium text-center text-[#0E1B4D]">Contact Us</h1>
    <form id="registrationForm" class="mt-8 max-w-sm mx-auto bg-white pl-8 pr-20 py-20 rounded-3xl text-[#0E1B4D]">
      <div class="mb-6">
        <label for="name" class="block text-sm mb-2"></label>
        <input type="text" id="name" name="firstname" placeholder={t('contact.input1')} class="w-full bg-transparent py-2 border-b-2 border-[#0E1B4D] focus:outline-none focus:ring-0 focus:border-[#0E1B4D]" required>
      </div>
      <div class="mb-6">
        <label for="email" class="block text-sm mb-2"></label>
        <input type="email" id="email" name="email" placeholder={t('contact.input2')} class="w-full bg-transparent py-2 border-b-2 border-[#0E1B4D] focus:outline-none focus:ring-0 focus:border-[#0E1B4D]" required>
      </div>
      <div class="mb-6">
        <label for="phone" class="block text-sm mb-2"></label>
        <input type="tel" id="phone" name="phone" placeholder={t('contact.input3')} class="w-full bg-transparent py-2 border-b-2 border-[#0E1B4D] focus:outline-none focus:ring-0 focus:border-[#0E1B4D]" required>
      </div>
      <div class="mb-6">
        <label for="portfolios" class="block text-sm mb-2"></label>
        <select id="portfolios" name="portfolios" class="w-full bg-transparent py-2 border-b-2 border-[#0E1B4D] focus:outline-none focus:ring-0 focus:border-[#0E1B4D]" required>
          <option value="">{t('contact.input4.option1')}</option>
          <option value="Serenity">Serenity</option>
          <option value="Classic">Classic</option>
          <option value="Grow">Grow</option>
        </select>
      </div>
      <div class="text-center">
        <button type="submit" class="mt-2 inline-flex items-center justify-center border border-[#0E1B4D] hover:bg-[#0E1B4D] hover:text-white w-full rounded-xl py-2 px-6">{t('contact.button')}</button>
      </div>
    </form>
  </div>

  <section class="grid grid-cols-1 md:grid-cols-3 text-start py-4 space-y-2 lg:space-y-0 px-4 w-full text-white max-w-screen-xl lg:h-[220px]">
    <div class="w-full h-full flex flex-col justify-center">
      <h1 class="mb-5 lg:mb-10 text-2xl font-medium">Other addresses</h1>
      <ul>
        <li>
          80 Broad St
          New York, NY 10004
        </li>
        <li class="mt-5">
          111 E Monument Ave UNIT 601
          Kissimmee, FL 34741
        </li>
      </ul>
    </div>
    <div class="w-full h-full flex flex-col justify-center lg:items-center">
      <div class="text-left">
        <h1 class="mb-3 lg:mb-10 mt-4 text-2xl font-medium">Get in Touch</h1>
        <p class="mb-3"><i class="fa fa-phone mr-2" style="transform: rotate(90deg);"></i>+1 (844) 844-0121</p>
        <p class="mb-3"><i class="fa fa-phone mr-2" style="transform: rotate(90deg);"></i>+1 (407) 686-5061</p>
        <p class="mb-3"><i class="fa fa-envelope mr-2"></i>info@qqcapitalfund.com</p>
      </div>
    </div>

    <div class="w-full h-full flex flex-row text-4xl space-x-4 justify-center items-end">
      <div>
        <a href="https://www.facebook.com/QQCapitalFund" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300"><i class="fab fa-facebook"></i></a>
        <a href="https://www.youtube.com/@qqcapitalfund4110" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300"><i class="fab fa-youtube"></i></a>
        <a href="https://www.instagram.com/qqcapitalfund_es/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300"><i class="fab fa-instagram"></i></a>
        <a href="https://www.linkedin.com/company/qqcapitalinvestmentfund/mycompany/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300"><i class="fab fa-linkedin"></i></a>
        <a href="https://www.tiktok.com/discover/qq-capital-fund" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300"><i class="fab fa-tiktok"></i></a>
      </div>
    </div>
    
  </section>

  <div class="mt-5 text-xs lg:mt-0 lg:absolute lg:top-[160px] lg:right-10 transform lg:rotate-[270deg] lg:origin-top-right text-white text-center">
    <p>Copyright © 2024 | QQ CAPITAL INVESTMENT FUND. All rights reserved.</p>
  </div>
</footer>

<div id="loader" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
  <div class="loader"></div>
</div>

<style>
  .main_banner {
    background-image: url("https://as1.ftcdn.net/v2/jpg/04/46/61/86/1000_F_446618660_FfPJdWIZkRopmf95fXZgvlvZa9mMasSK.jpg");
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
  }

  .loader {
    border: 8px solid #f3f3f3;
    border-top: 8px solid #3498db;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 2s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>

<!-- <form id="registrationForm" class="mt-8 max-w-md mx-auto">
  <div class="mb-4">
    <label for="name" class="block text-white text-sm font-bold mb-2">{t('contact.input1')}</label>
    <input type="text" id="name" name="firstname" class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600" required>
  </div>
  <div class="mb-4">
    <label for="email" class="block text-white text-sm font-bold mb-2">{t('contact.input2')}</label>
    <input type="email" id="email" name="email" class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600" required>
  </div>
  <div class="mb-4">
    <label for="phone" class="block text-white text-sm font-bold mb-2">{t('contact.input3')}</label>
    <input type="tel" id="phone" name="phone" class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600" required>
  </div>
  <div class="mb-4">
    <label for="portfolios" class="block text-white text-sm font-bold mb-2">{t('contact.input4')}</label>
    <select id="portfolios" name="portfolios" class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600" required>
      <option value="">{t('contact.input4.option1')}</option>
      <option value="Serenity">Serenity</option>
      <option value="Classic">Classic</option>
      <option value="Grow">Grow</option>
    </select>
  </div>
  <div class="text-center">
    <button type="submit" class="floating-button bg-[#034bd9] text-white px-4 py-2 rounded-full hover:bg-blue-950 focus:outline-none focus:ring-2 focus:ring-blue-600 w-64">{t('contact.button')}</button>
  </div>
</form> -->

<script>
  import { useTranslation } from "i18n/utils";

  function getLangFromUrl(pathname) {
    const segments = pathname.split('/');
    return segments[1] || 'en';
  }

  const lang = getLangFromUrl(window.location.pathname);
  const t = useTranslation(lang);

  const formElement = document.getElementById('registrationForm');
  const loaderElement = document.getElementById('loader');

  if (formElement) {
    formElement.addEventListener('submit', async function(e) {
      e.preventDefault();

      const form = e.target as HTMLFormElement | null;

      if (form && loaderElement) {
        loaderElement.classList.remove('hidden');

        const formData = new FormData(form);
        const jsonData: { [key: string]: string } = {};

        formData.forEach((value, key) => {
          jsonData[key] = value as string;
        });

        try {
          const response = await fetch('https://api.hsforms.com/submissions/v3/integration/submit/45958045/664177a5-c8d1-42bc-98bb-7bbd82939541', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              fields: Object.keys(jsonData).map(key => ({
                name: key,
                value: jsonData[key]
              }))
            })
          });

          loaderElement.classList.add('hidden');

          if (response.ok) {
            alert(t("contact.success"));
            form.reset();
          } else {
            alert(t('contact.error'));
          }
        } catch (error) {
          console.error('Error al enviar el formulario:', error);
          alert(t('contact.error'));
          loaderElement.classList.add('hidden');
        }
      }
    });
  } else {
    console.error("El formulario con el ID 'registrationForm' no se encontró en el DOM.");
  }
</script>
